// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum CategoryType {
  INCOME
  EXPENSE

  @@map("category_type")
}

model UserAccount {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email     String   @unique @db.VarChar(255)
  password  String   @db.VarChar(255)
  fullName  String   @map("full_name") @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp()
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp()

  incomeTransactions IncomeTransaction[]

  @@map("user_account")
  @@index([email], name: "idx_user_account_email")
}

model Category {
  id        String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name      String       @db.VarChar(100)
  type      CategoryType
  icon      String?      @db.VarChar(50) @default("wallet")
  createdAt DateTime     @default(now()) @map("created_at") @db.Timestamp()

  incomeTransactions IncomeTransaction[]

  @@unique([name, type], name: "name_type")
  @@map("category")
  @@index([type], name: "idx_category_type")
}

model IncomeTransaction {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId      String   @map("user_id") @db.Uuid
  nama        String?  @db.VarChar(255)
  nominal     Decimal  @db.Decimal(15, 2)
  categoryId  String   @map("category_id") @db.Uuid
  tanggal     DateTime @db.Date
  catatan     String?  @db.Text
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp()

  user     UserAccount @relation(fields: [userId], references: [id], onDelete: Cascade)
  category Category    @relation(fields: [categoryId], references: [id], onDelete: Restrict)

  @@map("income_transaction")
  @@index([userId], name: "idx_income_user_id")
  @@index([categoryId], name: "idx_income_category_id")
  @@index([tanggal], name: "idx_income_tanggal")
}
